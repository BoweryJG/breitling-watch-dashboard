\n-- Pedro's Dental Practice - Watch Dashboard Database Setup\n-- This script creates all required tables and populates them with realistic sample data\n\n-- Enable UUID extension\nCREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";\n\n-- Drop tables if they exist (for clean setup)\nDROP TABLE IF EXISTS testimonials CASCADE;\nDROP TABLE IF EXISTS appointments CASCADE;\nDROP TABLE IF EXISTS services CASCADE;\nDROP TABLE IF EXISTS patients CASCADE;\n\n-- Create patients table\nCREATE TABLE patients (\n    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n    auth_user_id UUID,\n    first_name TEXT NOT NULL,\n    last_name TEXT NOT NULL,\n    email TEXT UNIQUE NOT NULL,\n    phone TEXT,\n    date_of_birth DATE,\n    address TEXT,\n    medical_history JSONB DEFAULT '{}',\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create services table\nCREATE TABLE services (\n    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n    name TEXT NOT NULL,\n    description TEXT,\n    category TEXT NOT NULL,\n    estimated_duration INTERVAL,\n    price_range JSONB,\n    image_url TEXT,\n    is_yomi_technology BOOLEAN DEFAULT FALSE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create appointments table\nCREATE TABLE appointments (\n    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n    patient_id UUID REFERENCES patients(id) ON DELETE CASCADE,\n    service_id UUID REFERENCES services(id) ON DELETE SET NULL,\n    appointment_date DATE NOT NULL,\n    appointment_time TIME NOT NULL,\n    status TEXT CHECK (status IN ('scheduled', 'completed', 'cancelled')) DEFAULT 'scheduled',\n    notes TEXT,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create testimonials table\nCREATE TABLE testimonials (\n    id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n    patient_id UUID REFERENCES patients(id) ON DELETE CASCADE,\n    service_id UUID REFERENCES services(id) ON DELETE SET NULL,\n    rating INTEGER CHECK (rating >= 1 AND rating <= 5),\n    comment TEXT,\n    is_approved BOOLEAN DEFAULT FALSE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create indexes for better performance\nCREATE INDEX idx_appointments_date ON appointments(appointment_date);\nCREATE INDEX idx_appointments_patient ON appointments(patient_id);\nCREATE INDEX idx_appointments_service ON appointments(service_id);\nCREATE INDEX idx_testimonials_approved ON testimonials(is_approved);\nCREATE INDEX idx_patients_email ON patients(email);\n\n-- Enable Row Level Security (RLS)\nALTER TABLE patients ENABLE ROW LEVEL SECURITY;\nALTER TABLE appointments ENABLE ROW LEVEL SECURITY;\nALTER TABLE services ENABLE ROW LEVEL SECURITY;\nALTER TABLE testimonials ENABLE ROW LEVEL SECURITY;\n\n-- Create RLS policies (allow all operations for now - should be restricted in production)\nCREATE POLICY \"Allow all operations on patients\" ON patients FOR ALL USING (true);\nCREATE POLICY \"Allow all operations on appointments\" ON appointments FOR ALL USING (true);\nCREATE POLICY \"Allow all operations on services\" ON services FOR ALL USING (true);\nCREATE POLICY \"Allow all operations on testimonials\" ON testimonials FOR ALL USING (true);\n\n-- Insert sample patients\nINSERT INTO patients (first_name, last_name, email, phone, date_of_birth, address, medical_history, created_at) VALUES\n('Maria', 'Rodriguez', 'maria.rodriguez@email.com', '(555) 123-4567', '1985-03-15', '123 Main St, Miami, FL 33101', '{\"allergies\": [\"penicillin\"], \"conditions\": [\"diabetes\"]}', NOW() - INTERVAL '2 years'),\n('John', 'Smith', 'john.smith@email.com', '(555) 234-5678', '1978-07-22', '456 Oak Ave, Miami, FL 33102', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '1 year 6 months'),\n('Sarah', 'Johnson', 'sarah.johnson@email.com', '(555) 345-6789', '1990-11-08', '789 Pine St, Miami, FL 33103', '{\"allergies\": [\"latex\"], \"conditions\": []}', NOW() - INTERVAL '8 months'),\n('David', 'Brown', 'david.brown@email.com', '(555) 456-7890', '1982-09-14', '321 Elm St, Miami, FL 33104', '{\"allergies\": [], \"conditions\": [\"hypertension\"]}', NOW() - INTERVAL '1 year 2 months'),\n('Lisa', 'Garcia', 'lisa.garcia@email.com', '(555) 567-8901', '1995-05-30', '654 Maple Ave, Miami, FL 33105', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '6 months'),\n('Michael', 'Wilson', 'michael.wilson@email.com', '(555) 678-9012', '1973-12-03', '987 Cedar St, Miami, FL 33106', '{\"allergies\": [\"iodine\"], \"conditions\": [\"diabetes\"]}', NOW() - INTERVAL '3 years'),\n('Jennifer', 'Martinez', 'jennifer.martinez@email.com', '(555) 789-0123', '1988-08-18', '147 Birch St, Miami, FL 33107', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '4 months'),\n('Robert', 'Anderson', 'robert.anderson@email.com', '(555) 890-1234', '1980-01-25', '258 Spruce Ave, Miami, FL 33108', '{\"allergies\": [\"sulfa\"], \"conditions\": []}', NOW() - INTERVAL '1 year 8 months'),\n('Amanda', 'Taylor', 'amanda.taylor@email.com', '(555) 901-2345', '1992-06-12', '369 Walnut St, Miami, FL 33109', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '2 months'),\n('Christopher', 'Thomas', 'christopher.thomas@email.com', '(555) 012-3456', '1986-04-07', '741 Cherry Ave, Miami, FL 33110', '{\"allergies\": [], \"conditions\": [\"asthma\"]}', NOW() - INTERVAL '10 months'),\n('Jessica', 'Hernandez', 'jessica.hernandez@email.com', '(555) 123-7890', '1991-10-16', '852 Poplar St, Miami, FL 33111', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '3 weeks'),\n('Daniel', 'Moore', 'daniel.moore@email.com', '(555) 234-8901', '1975-02-28', '963 Sycamore Ave, Miami, FL 33112', '{\"allergies\": [\"penicillin\"], \"conditions\": []}', NOW() - INTERVAL '1 year 4 months'),\n('Michelle', 'Jackson', 'michelle.jackson@email.com', '(555) 345-9012', '1987-09-09', '159 Hickory St, Miami, FL 33113', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '7 months'),\n('Kevin', 'White', 'kevin.white@email.com', '(555) 456-0123', '1983-12-20', '753 Willow Ave, Miami, FL 33114', '{\"allergies\": [], \"conditions\": [\"diabetes\"]}', NOW() - INTERVAL '1 year 1 month'),\n('Rachel', 'Lewis', 'rachel.lewis@email.com', '(555) 567-1234', '1994-07-05', '486 Ash St, Miami, FL 33115', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '5 months'),\n('Thomas', 'Lee', 'thomas.lee@email.com', '(555) 678-2345', '1989-03-11', '624 Beech Ave, Miami, FL 33116', '{\"allergies\": [\"latex\"], \"conditions\": []}', NOW() - INTERVAL '1 week'),\n('Nicole', 'Walker', 'nicole.walker@email.com', '(555) 789-3456', '1976-11-24', '357 Redwood St, Miami, FL 33117', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '9 months'),\n('Matthew', 'Hall', 'matthew.hall@email.com', '(555) 890-4567', '1984-08-02', '791 Fir Ave, Miami, FL 33118', '{\"allergies\": [], \"conditions\": [\"hypertension\"]}', NOW() - INTERVAL '1 year 7 months'),\n('Stephanie', 'Allen', 'stephanie.allen@email.com', '(555) 901-5678', '1993-01-17', '135 Sequoia St, Miami, FL 33119', '{\"allergies\": [], \"conditions\": []}', NOW() - INTERVAL '4 days'),\n('Ryan', 'Young', 'ryan.young@email.com', '(555) 012-6789', '1981-05-26', '468 Magnolia Ave, Miami, FL 33120', '{\"allergies\": [\"iodine\"], \"conditions\": []}', NOW() - INTERVAL '2 years 3 months');\n\n-- Insert dental services with YOMI technology procedures\nINSERT INTO services (name, description, category, estimated_duration, price_range, is_yomi_technology, created_at) VALUES\n('